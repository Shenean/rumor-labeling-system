## 评估结论（对照 file\md）

* 现有仓库并未“完全实现”。它更像是“目录结构 + 数据模型 + 少量后端接口雏形 + 前端页面骨架”的脚手架。

* 与标准文档的主要差距集中在三类：接口路径/返回结构不一致、多个核心模块缺失（审核/系统设置/完整任务调度）、前端大量页面仍为静态或模拟数据导致前后端无法形成闭环。

## 对照口径（标准来源）

* 后端接口标准：parsed.html（定义 auth/sample/detection/task/event/review/export/settings 等模块与路径）。

* 前端页面标准：parsed (1).html（定义登录、仪表盘、样本、任务分配、标注、审核、事件、导出、系统设置等页面）。

* 模块流程与数据结构标准：parsed (2).html（目录结构与核心表设计）。

## 差距清单（优先级从高到低）

### 1) 前后端闭环不可用（最高优先级）

* 标准要求：登录拿到有效令牌后访问受保护接口。

* 现状：前端登录与多页面仍为模拟数据/本地随机结果，且后端多数接口要求令牌校验，导致一旦切换到真实调用会直接失败。

### 2) 后端接口与标准不一致/缺失

* 标准接口族包含：/api/auth/*、/api/detect*、/api/tasks\*、/api/review/*、/api/settings/*、/api/export/\* 等。

* 现状：后端仅注册了 rumor/annotation/samples/events/export/users 六个蓝图，缺失 review/settings/task 的完整资源化接口，同时 detect/history、样本更新/详情、批量导入等也缺。

* 同时，标准要求统一返回 {code,message,data}；现有接口返回结构不统一。

### 3) 数据模型“基本对齐”但流程未落地

* 目录结构与核心表（User/Sample/Annotation/Task/Event/ModelLog）与标准总体一致，属于“已搭好地基”。

* 任务-样本关联、审核记录、系统设置与操作日志等关键表在标准中需要，但当前缺失或未实现。

### 4) 前端页面实现度不足

* 页面文件存在一定覆盖，但多数页面未接入真实接口、缺少任务分配/审核/导出/系统设置的完整交互与路由落地。

## 目标与验收标准（以 file/md 为准）

* 后端：覆盖文档中各模块接口（至少核心路径与权限逻辑），返回结构统一，可通过最小集成测试。

* 前端：页面不再使用静态/模拟数据；登录—样本—任务—标注—审核—事件—导出—设置形成可跑通闭环。

## 实施计划（确认后开始改动）

### 1) 后端对齐标准接口（优先做“可跑通”闭环）

1. 建立 auth 蓝图并对齐路径：/api/auth/login、/api/auth/user、/api/auth/logout（刷新/改密/注册按需补齐）。
2. detection：实现 /api/detect（复用现有 mock 模型）与 /api/detect/history（基于 ModelLog 或新增检测历史表）。
3. samples：补齐 GET /api/samples/{id}、PUT /api/samples/{id}、POST /api/samples/batch\_import，并统一分页/筛选参数。
4. tasks（重点）：按标准实现 /api/tasks 的 CRUD、claim/unclaim、task samples、label 提交、progress；补充必要的数据关联（任务-样本关联表或样本增加 task\_id，二选一并统一到文档口径）。
5. events：补齐 events 的 CRUD 与必要的关联操作；保留 /cluster 作为扩展。
6. review：新增 review 蓝图与审核记录存储（任务审核、事件审核），并实现待审核列表与提交审核结果。
7. export：按标准拆分导出端点（samples/annotations/audits/reports）；同时修复当前导出接口中数据库会话引用问题，并确定“返回下载链接”还是“直接返回文件流”的统一策略。
8. settings：新增 settings 蓝图，实现系统配置、角色/权限、用户管理、操作日志查看（需要时新增表）。
9. 全局统一：统一返回格式 {code,message,data}，补充参数校验与错误处理。

### 2) 前端从“骨架”升级为“真实业务”

1. 去除 mock：把 services 中的模拟登录/静态数据替换为真实接口调用，并与后端路径保持一致。
2. 路由与权限：按标准页面补齐路由（任务分配、审核、导出、系统设置），并与角色权限一致。
3. 页面逐个打通：

   * 登录 → 获取当前用户

   * 样本列表/详情/编辑/批量导入

   * 任务分配与标注工作台（拉取任务样本、提交标注、显示进度）

   * 审核页面（拉取待审、提交审核意见）

   * 事件聚合（列表/详情/可触发聚类）

   * 导出与报表（触发导出并下载）
4. 开发体验：补齐本地开发代理配置，确保前端以 /api 访问时能正确转发到后端。

### 3) 验证与交付

* 后端：为关键接口增加最小集成测试（登录、样本 CRUD、任务流、审核流、导出），确保关键路径可复现通过。

* 前端：做一套端到端“冒烟流程”（登录→创建样本→创建任务→标注→审核→导出）。

## 我需要你确认的唯一点（不需要你补充任何细节）

* 是否严格以 file\md 中的接口路径与返回结构作为最终验收标准（将对现有 /api/users、/api/rumor 等路径做兼容或迁移）。是的

